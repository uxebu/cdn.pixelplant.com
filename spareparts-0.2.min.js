/**
 * spareparts is (C) 2012 uxebu Inc.
 * 
 * No permission or right to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software is granted.
 * All rights reserved to the copyright holders.
 */
(function(){var Group=bonsai.Group,tools=bonsai.tools,Button=function(){Group.call(this);this.childrenWrapper=(new Group).addTo(this);this.eventArea=(new Group).attr({opacity:0,cursor:"pointer"}).addTo(this);this.stateChildren={normal:new Group,hover:new Group,active:new Group};this.setupConnections();this.childrenWrapper.addChild(this.stateChildren.normal)};
Button.prototype=tools.mixin(Object.create(Group.prototype),{childrenWrapper:null,eventArea:null,stateChildren:null,isMouseDown:!1,isMouseOver:!1,type:"Group",addActiveStateChild:function(b,c){this.addStateChild(b,"active",c)},addEventAreaChild:function(b,c){this.eventArea.addChild(b,c)},addHoverStateChild:function(b,c){this.addStateChild(b,"hover",c)},addNormalStateChild:function(b,c){this.addStateChild(b,"normal",c)},addStateChild:function(b,c,h){this.stateChildren[c].addChild(b,h)},displayState:function(b){this.stateChildren[b].children().length&&
this.childrenWrapper.clear().addChild(this.stateChildren[b])},onMouseDown:function(){this.isMouseDown=!0;this.displayState("active")},onMouseUp:function(){this.isMouseDown=!1;this.displayState(this.isMouseOver?"hover":"normal")},onMouseOver:function(){this.isMouseOver=!0;this.displayState(this.isMouseDown?"active":"hover")},onMouseOut:function(){this.isMouseOver=!1;this.displayState(this.isMouseDown?"hover":"normal")},setupConnections:function(){this.eventArea.on("mouseover",tools.hitch(this,"onMouseOver"));
this.eventArea.on("mouseout",tools.hitch(this,"onMouseOut"));this.eventArea.on("pointerdown",tools.hitch(this,"onMouseDown"));this.eventArea.on("pointerup",tools.hitch(this,"onMouseUp"))}});exports.Button=Button;(function(){function b(a,c){var b=[],d="__string__"+ +new Date,a=a.replace(/(['"])(?:\\\1|[^\1])*?\1/g,function(a){b.push(a);return d}),a=a.replace(/[^}]+\{/g,function(a){a=a.replace(/^\s+|\s+$/,"");return a.replace(/^|(,)/g,"$1 "+c+" ").replace(/^\s|(\s)\s+/g,"$1")});return a=a.replace(RegExp(d,"g"),function(){return b.shift()})}function c(a,c){return d(function(){return(c||this._owner).getStyle(a)},function(b){/color/i.test(a)?b=bonsai.color(b).rgba():/fontSize/i.test(a)||/lineHeight/i.test(a)||
"number"===typeof b&&(b+="px");(c||this._owner).setStyle(a,b)},!0)}function h(){return this._autoSize}function j(a){this._autoSize=a=a||"none";switch(a){case "none":this._owner._innerContainer.setStyles({"float":"",width:"100%",height:"100%"});break;case "left":this._owner._innerContainer.setStyles({"float":"left",width:"auto",height:"auto"});this._owner.setStyles({width:"auto",height:"auto"});break;case "right":this._owner._innerContainer.setStyles({"float":"right",width:"auto",height:"auto"});this._owner._innerText.setStyle("float",
"right");this._owner._innerText.setStyle("textAlign","right");break;case "center":this._owner._innerContainer.setStyles({display:"inline-block",width:"auto",height:"auto"}),this._owner.setStyle("textAlign","center")}}function k(){return this._editable}function l(a){this._editable=!!a;this._owner._innerContainer.setAttribute("contenteditable",a)}function m(){return this._owner._innerText.getAttribute("innerHTML")}function n(a){var b=this._owner;b._innerText.setAttribute("innerHTML",a);b.emit("change")}
function o(){return this._maxLength}function p(a){a!==this._maxLength&&(this._maxLength=a)}function q(){return this._password}function r(a){this._password=!!a;a&&(this.text=Array(this._owner._innerText.getAttribute("innerHTML").length+1).join("*"))}function s(){return f.unescapeHtml(this._owner._innerText.getAttribute("innerHTML"))}function t(a){var a=null===this._maxLength?a:a.slice(0,this._maxLength),b=this._owner;b._innerText.setAttribute("innerHTML",f.escapeHtml(a));b.emit("change")}function u(){return this._selectable}
function v(){}function w(){return this._styleSheet}function x(a){a?(this._styleSheet=a=b(a,this._owner._cssSelectorPrefix),this._owner._style||(this._owner._style=new g("style"),this._owner.addChild(this._owner._style)),this._defaultStyleSheet||(this._defaultStyleSheet=b(y,this._owner._cssSelectorPrefix)),this._owner._style.setAttribute("innerHTML",this._defaultStyleSheet+a)):this._styleSheet=""}function z(){return this._wordwrap}function A(a){a?this._owner._innerText.setStyles({whiteSpace:"normal",
display:""}):this._owner._innerText.setStyles({whiteSpace:"nowrap",display:"inline-block"});this._wordwrap=!!a}function B(){return this._width}function C(a){this._width=a;"none"===this._autoSize&&(this._owner.setStyle("width",a+"px"),this._owner._innerContainer.setStyle("width",a-2*this.lineWidth+"px"))}function D(){return this._height}function E(a){this._height=a;"none"===this._autoSize&&(this._owner.setStyle("height",a+"px"),this._owner._innerContainer.setStyle("height",a-2*this.lineWidth+"px"))}
function F(){return this._lineWidth}function G(a){this._lineWidth=a;this._owner._innerContainer.setStyle("borderWidth",a+"px");this.width=this.width;this.height=this.height}function f(a){g.call(this,"div");this._domID="bs-textfield-"+this.id;this._domInnerClass=this._domID+"-inner";this._cssSelectorPrefix="#"+this._domID+" ."+this._domInnerClass;this.setAttribute("id",this._domID);this._innerContainer=(new g("div",{},{borderStyle:"solid",overflow:"hidden",width:"100%",height:"100%",display:"inline-block",
boxSizing:"border-box",MozBoxSizing:"border-box"})).addTo(this);this._innerText=new g("span",{"class":this._domInnerClass});this._innerContainer.addChild(this._innerText);Object.defineProperties(this._attributes,{align:c("textAlign",this._innerContainer),_autoSize:e(null,!0,!0),autoSize:d(h,j,!0),fillColor:c("backgroundColor",this._innerContainer),lineColor:c("borderColor",this._innerContainer),lineHeight:c("lineHeight",this._innerContainer),editable:d(k,l,!0),fontFamily:c("fontFamily"),fontSize:c("fontSize"),
htmlText:d(m,n,!0),_maxLength:e(null,!0,!0),maxLength:d(o,p,!0),_password:e(!1,!0,!0),password:d(q,r,!0),_selectable:e(!0,!0,!0),selectable:d(u,v,!0),_styleSheet:e("",!0,!0),styleSheet:d(w,x,!0),_text:e("",!0,!0),text:d(s,t,!0),textFillColor:c("color"),textLineColor:c("-webkit-stroke-color"),textLineWidth:c("-webkit-stroke-width"),_wordwrap:e(!1,!0,!0),wordwrap:d(z,A,!0),_lineWidth:e(0,!0,!0),lineWidth:d(F,G,!0),_width:e(0,!0,!0),width:d(B,C,!0),_height:e(0,!0,!0),height:d(D,E,!0)});this.attr({align:"left",
autoSize:"none",lineColor:"black",lineWidth:1,fillColor:"",textFillColor:"black",fontFamily:"",fontSize:"",htmlText:"",text:a||"",wordwrap:!1,height:100,width:100,styleSheet:" /* trigger defaults to be set */ "})}var g=bonsai.DOMElement,i=bonsai.tools,d=i.descriptorAccessor,e=i.descriptorData,y="a{color:#000;text-decoration:none;}";f.prototype=i.beget(g.prototype);f.escapeHtml=function(a){return a.replace(/&/g,"&amp;").replace(/ /g,"&nbsp; ").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,
"<br/>")};f.unescapeHtml=function(a){return a.replace(/&amp;/g,"&").replace(/&nbsp; /g," ").replace(/<br\/>/g,"\n").replace(/<(?:.|\n)*?>/gm,"").replace(/\&lt;/g,"<").replace(/\&gt;/g,">")};exports.TextField=f})();}());
