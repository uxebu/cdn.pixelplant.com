;(function(){'use strict';function z(f,d){for(var a=0,b=f.length;a<b;a+=1)if(f[a]>d)return a;return f.length}function A(f){var d=this.children=f.children,a=d.length;this._displayList=f;this._clipMap=Array(a);this._flattenedChildren=d.slice();this._nextAddSwfDepth=void 0;this._swfDepthMap=Array(a)}function H(){this.stop()}function y(f,d){for(;!(d in f)&&f.previousStyle;)f=f.previousStyle;return f[d]||null}function I(f,d,a){var b=a.characters[f];b&&(b.symbolClass=d,a.vmToplevel.setPreConstructorHook(d,function(b){B.getInstance(f,
a,C.initSprite,b)}))}var l={};A.prototype={add:function(f,d){var a=this._flattenedChildren,b=a.length;if(void 0===d||d>b)d=b;a.splice(d,0,f);var c=this._swfDepthMap,e=this._nextAddSwfDepth;c.splice(d,0,e);var g=this._clipMap,i=g[d-1];if(i){var h=i.swfClipDepth,c=c.indexOf(h);-1===c&&(c=b+1);if(e>h||d>c)i=void 0}g.splice(d,0,i);return i?i.displayList.add(f,d-1-a.indexOf(i)):this._displayList.add(f,d)},clear:function(){this._swfDepthMap.length=this._clipMap.length=0;return this._displayList.clear()},
contains:function(f){return this._displayList.contains(f)},getSwfObject:function(f){return this._flattenedChildren[this._swfDepthMap.indexOf(f)]},placeSwfClip:function(f,d,a,b,c,e){f.treeRepresentation=d;d.attr("clip",f);d.swfClipDepth=b;d.__flash__=e;f=this.placeSwfObject(d,a,c,e);a=this._clipMap;b=z(this._swfDepthMap,b);for(c=f;c<b;c+=1)a[c]=d;d.displayList.add(this._flattenedChildren.slice(f+1,b));return f},placeSwfObject:function(f,d,a,b){var c=this._swfDepthMap,e=this._nextAddSwfDepth;this._nextAddSwfDepth=
d;d=z(c,d);a&&b?a.addChildAt(b,d-(this._flattenedChildren.length-a.numChildren)):this.add(f,d);this._nextAddSwfDepth=e;return d},remove:function(f){var d=this._flattenedChildren,a=d.indexOf(f),b;-1!==a&&(b=this._clipMap.splice(a,1)[0],d.splice(a,1),this._swfDepthMap.splice(a,1));return(b?b.displayList:this._displayList).remove(f)},removeSwfObject:function(f){f=this._swfDepthMap.indexOf(f);-1!==f&&this.remove(this.children[f])}};l.module$exports=A;l.module$exports&&(l=l.module$exports);var m={},J=
l,D={Bitmap:"flash.display.Bitmap",Button:"flash.display.SimpleButton",Html:"flash.text.TextField",Morph:"flash.display.MorphShape",Shape:"flash.display.Shape",Sprite:"flash.display.MovieClip",Text:"flash.text.StaticText"},w={getInstance:function d(a,b,c,e){var g=b.vmToplevel,i,h=b.characters[a];h.create&&(b.getInstance||(b.getInstance=function(a){return d(a,b,c)}),i=h.create(b.getInstance));var k=h.type;e?(a=tools.getPrivateObjectOf(e),w.initShimObject(e,a,i)):a=(e=w.createShimObject(k,i,h.symbolClass,
g,0===a))&&tools.getPrivateObjectOf(e);a&&(i=a.raw);i.__flash__=e;i.displayList&&(i.displayList=new J(i.displayList));"Sprite"===k&&c(h,i,b);return i},createShimObject:function(d,a,b,c,e){if(!b)if(d in D)b=D[d];else return;d=c.getType(b).prototype;d=Object.create(d,d.__slotDescriptors__);b=tools.getPrivateObjectOf(d);b.isRootMovie=!!e;w.initShimObject(d,b,a);return d},initShimObject:function(d,a,b){b&&(a.raw=b);d.__preConstruct__()}};m.module$exports=w;m.module$exports&&(m=m.module$exports);var r=
{},l=function(d,a){var d=d||[],b,c,e=d.length;this.counter=e;this.success=a||function(){};if(0===e)return this.success(),this;for(b=0;b<e;b++)c=d[b],this["preload"+c.type](c)};l.prototype={preloadBitmap:function(d){var a=this;(new Bitmap(d.path)).on("load",function(){a.callback()})},preloadFontFamily:function(d){var a=this;(new FontFamily(d.name,[d.path])).on("load",function(){a.callback()})},callback:function(){this.counter--;0===this.counter&&this.success()}};r.module$exports=l;r.module$exports&&
(r=r.module$exports);var p={},K=m,L=Math.max,M=Math.min,q={gotoFrame:function(d,a,b){var c=d.swf,e=c.currentDisplayList||[],a=c.currentDisplayList=c.frames[a],d=c.newChildren=q.updateDisplayList(e,a,d,b);return!(!d||!d.length)},playSwfFrame:function a(b,c,e){e||(e=[]);var g=b.swf&&b.swf.frames;b.isPlaying&&1===b.length()&&b.stop();b.isPlaying&&g&&q.gotoFrame(b,b.currentFrame,c)&&e.push(b);if("function"===typeof b.children)for(var b=b.children(),g=0,i;i=b[g];g+=1)a(i,c,e);return e},styleCharacter:function(a,
b,c,e){if(a&&!a.__touchedByActionScript__){var g=y(c,"matrix"),i=y(c,"colorTransform"),h=y(c,"getFilters"),h=h?h(b.filter):null;g?a.attr("matrix",new b.Matrix(g.sx,g.rotateSkew0,g.rotateSkew1,g.sy,g.tx,g.ty)):a.attr("matrix",new b.Matrix);(e=e&&e.colorTransform)&&e.isAlphaOnly&&a.attr("opacity",e.previousOpacity);if(i){var k,j,u,x,l,n;(j=i.add)?(e=j.r,g=j.g,k=j.b,j=j.a):e=g=k=j=0;(n=i.mul)?(u=n.r/256,x=n.g/256,l=n.b/256,n=n.a/256):u=x=l=n=1;var m=a.attr("opacity");0===e+g+k&&1===u*x*l?(i.isAlphaOnly=
!0,i.previousOpacity=m,a.attr("opacity",M(1,L(0,m*n+j/255)))):(b=new b.filter.ColorMatrix([u,0,0,0,e/255,0,x,0,0,g/255,0,0,l,0,k/255,0,0,0,n,j/255]),h?h.push(b):h=[b])}a.attr("filters",h);(a=a._animation)&&a.step(c.ratio/65535||0)}},updateDisplayList:function(a,b,c,e){if(a===b)return null;for(var g=[],i=Math.max(a.length,b.length),h=0;h<i;h+=1){var k=a[h],j=b[h];if(k!==j){var u=k&&k.isModified?k.firstPlacement:k,l=j&&j.isModified?j.firstPlacement:j,m=c.displayList.getSwfObject(h);j?l===u?(u=l.clipDepth?
m.attr("clip"):m,q.styleCharacter(u,e.bonsai,j,k)):(k&&q.removeCharacter(m,k.objectName),k=K.getInstance(j.isModified?j.firstPlacement.characterId:j.characterId,e,q.initSprite),q.styleCharacter(k,e.bonsai,j),g.push({bonsaiObject:k,clipDepth:j.clipDepth,depth:h,objectName:j.objectName})):q.removeCharacter(m,k.objectName)}}return g},initSprite:function(a,b,c){var e=a.frames;b.swf={frameLabels:a.frameLabels||{},frames:e};if(b.length){b.length(e.length);for(var e=(a=a.stopCalls)?a.length:0,g=0;g<e;g+=
1)b.on(a[g],H)}q.gotoFrame(b,0,c)},removeCharacter:function(a,b){if(a){var c=a.__flash__,e=c.parent;c&&e?(e.removeChild(c),b&&(e[b]=null)):a.remove()}}};p.module$exports=q;p.module$exports&&(p=p.module$exports);var v={},N=p,E={constructChildren:function(a,b){var c,e=a.swf;if(e&&e.newChildren){for(var g=e.newChildren,i=0,h;h=g[i];i+=1){var k=h.clipDepth,j=h.bonsaiObject,l=j.__flash__,m=h.objectName;k?(c=new bonsai.Group,c.attr("data","clip"),a.displayList.placeSwfClip(j,c,h.depth,k,b,l)):a.displayList.placeSwfObject(j,
h.depth,b,l);l&&(m&&(l[tools.expando].name=m),l.constructor());m&&(b[m]=l)}e.newChildren=null}},"goto":function(a,b,c,e){N.gotoFrame(a,b,e)&&E.constructChildren(a,c)}};v.module$exports=E;v.module$exports&&(v=v.module$exports);var s={},O=p,P=v.constructChildren;s.module$exports={playFirstFrame:function(a,b){var c=a.__flash__;b.vmToplevel.global.stage.addChildAt(c,0);c.constructor()},playFrame:function(a,b){for(var c=O.playSwfFrame(a,b),e=0,g;g=c[e];e+=1)P(g,g.__flash__)}};s.module$exports&&(s=s.module$exports);
var l={},B=m,Q=r,F=v,G=s,C=p,m={playSwf:function(a,b,c,e){var c=a.bonsai,g=c.stage,i=a.characters[0].symbolClasses;i&&Object.keys(i).forEach(function(b){var b=i[b],c;for(c in b)b.hasOwnProperty(c)&&I(c,b[c],a)});c.stage.toplevel=a.vmToplevel;var h=B.getInstance(0,a,C.initSprite),c=a.vmToplevel;c.getType("flash.display.Sprite").prototype.__constructChildren__=F.constructChildren;c.getType("flash.display.MovieClip").prototype.__goto__=function(b,c,e){return F.goto(b,c,e,a)};new Q(e,function(){g.once("tick",
function(){this.on("tick",function(){G.playFrame(h,a)})}).once("tick",function(){G.playFirstFrame(h,a)}).setFramerate(b)});return h},preprocessDictionary:function(a){for(var b in a){var c=a[b];if("Sprite"===c.type){for(var e=a,g=b,i=c,h=c.frames,k=[],j=0,l=h.length;j<l;j+=1){var m=h,r=j,n;n=h[j];var q=j;if(n&&n.length){k=k.slice();k.frameIndex=q;for(var p=0,v=n.length;p<v;p+=1){var o=n[p],s=o.depth,t=o.name;if("RemoveObject2"===t||"RemoveObject"===t)delete k[s];else if("PlaceObject"===t||"PlaceObject2"===
t||"PlaceObject3"===t){if(o.isModified){if(t=k[s])k[s]=o,o.firstPlacement=t.isModified?t.firstPlacement:t,o.previousStyle=t}else if(o.isNew||o.isReplacement)k[s]=o;else throw Error("Unrecognized tag. Expecting .isModified, .isNew, or .isReplacement (Frame: "+q+", depth: "+s+")");o.getFilters&&(o.getFilters=Function("filter","return "+o.getFilters))}else console.log("skipping TOFIX displaylist tag",o)}}n=k;k=m[r]=n}i.frames=h;e[g]=c}}return a}},r=Function("return this")();r.exports=r.exports||{};r.exports.transwf=
m;l.module$exports=m;l.module$exports&&(l=l.module$exports)})();
;(function(){'use strict';function v(g,a){for(var b=0,c=g.length;b<c;b+=1)if(g[b]>a)return b;return g.length}function w(g){var a=this.children=g.children,b=a.length;this._displayList=g;this._clipMap=Array(b);this._flattenedChildren=a.slice();this._nextAddSwfDepth=void 0;this._swfDepthMap=Array(b)}function x(g,a,b){if(!g||!g.length)return a;var c=a.slice();c.frameIndex=b;for(var d=0,e=g.length;d<e;d+=1){var h=g[d],f=h.name,i=h.depth;if("PlaceObject"===f||"PlaceObject2"===f||"PlaceObject3"===f){if(!h.isNew&&!h.isModified&&
!h.isReplacement)throw console.log("Crashing tag:",h),Error("Expecting .isModified, .isNew, or .isReplacement (Frame:"+b+", depth:"+i+")");var j=h.isNew?G:a[i],k=h;c[i]=k;k.placementId=h.isModified?j.placementId:++H;h.isModified&&(k.characterId=j.characterId,k.clipDepth=j.clipDepth,k.objectName=j.objectName);"getFilters"in k&&(k.getFilters=Function("filter","return "+k.getFilters));I.forEach(function(a){!(a in k)&&a in j&&(k[a]=j[a])})}else"RemoveObject"==f||"RemoveObject2"==f?delete c[i]:console.error("Unrecognized tag type: "+
f+", (Frame:"+b+", depth:"+h.depth+")")}return c}function J(){this.stop()}function K(g,a){return g&&a?g===a||g.every(function(b,c){return b===a[c]}):g===a}function y(g,a,b){var c=b.characters[g];c&&(c.symbolClass=a,b.vmToplevel.setPreConstructorHook(a,function(a){z.getInstance(g,b,A.initSprite,a)}))}function L(g){var a=g.characters[0].symbolClasses;a&&Object.keys(a).forEach(function(b){var b=a[b],c;for(c in b)b.hasOwnProperty(c)&&y(c,b[c],g)})}function M(g){var a=g.vmToplevel;a.getType("flash.display.Sprite").prototype.__constructChildren__=
B.constructChildren;a.getType("flash.display.MovieClip").prototype.__goto__=function(a,c,d){return B.goto(a,c,d,g)}}function N(g,a,b,c,d){new O(g,function(){a.once("tick",function(){a.on("tick",function(){C.playFrame(b,c)});C.playFirstFrame(b,c)});a.setFramerate(d)})}var m={};w.prototype={add:function(g,a){var b=this._flattenedChildren,c=b.length;if(void 0===a||a>c)a=c;b.splice(a,0,g);var d=this._swfDepthMap,e=this._nextAddSwfDepth;d.splice(a,0,e);var h=this._clipMap,f=h[a-1];if(f){var i=f.swfClipDepth,
d=d.indexOf(i);-1===d&&(d=c+1);if(e>i||a>d)f=void 0}h.splice(a,0,f);return f?f.displayList.add(g,a-1-b.indexOf(f)):this._displayList.add(g,a)},clear:function(){this._swfDepthMap.length=this._clipMap.length=0;return this._displayList.clear()},contains:function(g){return this._displayList.contains(g)},getSwfObject:function(g){return this._flattenedChildren[this._swfDepthMap.indexOf(g)]},placeSwfClip:function(g,a,b,c,d,e){g.treeRepresentation=a;a.attr("clip",g);a.swfClipDepth=c;a.__flash__=e;g=this.placeSwfObject(a,
b,d,e);b=this._clipMap;c=v(this._swfDepthMap,c);for(d=g;d<c;d+=1)b[d]=a;a.displayList.add(this._flattenedChildren.slice(g+1,c));return g},placeSwfObject:function(g,a,b,c){var d=this._swfDepthMap,e=this._nextAddSwfDepth;this._nextAddSwfDepth=a;a=v(d,a);b&&c?b.addChildAt(c,a-(this._flattenedChildren.length-b.numChildren)):this.add(g,a);this._nextAddSwfDepth=e;return a},remove:function(g){var a=this._flattenedChildren,b=a.indexOf(g),c;-1!==b&&(c=this._clipMap.splice(b,1)[0],a.splice(b,1),this._swfDepthMap.splice(b,
1));return(c?c.displayList:this._displayList).remove(g)},removeSwfObject:function(g){g=this._swfDepthMap.indexOf(g);-1!==g&&this.remove(this.children[g])}};m.module$exports=w;m.module$exports&&(m=m.module$exports);var n={},P=m,D={Bitmap:"flash.display.Bitmap",Button:"flash.display.SimpleButton",Html:"flash.text.TextField",Morph:"flash.display.MorphShape",Shape:"flash.display.Shape",Sprite:"flash.display.MovieClip",Text:"flash.text.StaticText"},t={getInstance:function a(b,c,d,e){var h=c.vmToplevel,
f,i=c.characters[b];i.create&&(c.getInstance||(c.getInstance=function(b){return a(b,c,d)}),f=i.create(c.getInstance));var j=i.type;e?(b=tools.getPrivateObjectOf(e),t.initShimObject(e,b,f)):b=(e=t.createShimObject(j,f,i.symbolClass,h,0===b))&&tools.getPrivateObjectOf(e);b&&(f=b.raw);f.__flash__=e;f.displayList&&(f.displayList=new P(f.displayList));"Sprite"===j&&d(i,f,c);return f},createShimObject:function(a,b,c,d,e){if(!c)if(a in D)c=D[a];else return;a=d.getType(c).prototype;a=Object.create(a,a.__slotDescriptors__);
c=tools.getPrivateObjectOf(a);c.isRootMovie=!!e;t.initShimObject(a,c,b);return a},initShimObject:function(a,b,c){c&&(b.raw=c);a.__preConstruct__()}};n.module$exports=t;n.module$exports&&(n=n.module$exports);var o={},m=function(a,b){var a=a||[],c,d,e=a.length;this.counter=e;this.success=b||function(){};if(0===e)return this.success(),this;for(c=0;c<e;c++)d=a[c],this["preload"+d.type](d)};m.prototype={preloadBitmap:function(a){var b=this;(new Bitmap(a.path)).on("load",function(){b.callback()})},preloadFontFamily:function(a){var b=
this;(new FontFamily(a.name,[a.path])).on("load",function(){b.callback()})},callback:function(){this.counter--;0===this.counter&&this.success()}};o.module$exports=m;o.module$exports&&(o=o.module$exports);var r={},I=["matrix","colorTransform","getFilters","nonInteractive"],G={},H=0;r.module$exports={preprocessDictionary:function(a){for(var b in a){var c=a[b];if("Sprite"===c.type){for(var d=a,e=b,h=c,f=c.frames,i=[],j=0,k=f.length;j<k;j+=1)i=f[j]=x(f[j],i,j);h.frames=f;d[e]=c}}return a},_preProcessFrame:x};
r.module$exports&&(r=r.module$exports);var p={},E=n,Q=Math.max,R=Math.min,l={gotoFrame:function(a,b,c){var d=a.swf,e=d.currentDisplayList||[],b=d.currentDisplayList=d.frames[b],a=d.newChildren=l.updateDisplayList(e,b,a,c);return!(!a||!a.length)},playSwfFrame:function(a,b,c){c||(c=[]);a.isPlaying&&(1===a.length()?a.stop():a.swf&&a.swf.frames&&l.gotoFrame(a,a.currentFrame,b)&&c.push(a));if("function"===typeof a.children)for(var a=a.children(),d=0,e;e=a[d];d+=1)l.playSwfFrame(e,b,c);return c},styleCharacter:function(a,
b,c,d){if(a&&!a.__touchedByActionScript__){var e=c.matrix,h=c.colorTransform,f=c.getFilters,i=!!c.nonInteractive,j,k,m,u,n=!1;d&&(j=d.matrix,k=d.colorTransform,(m=d.getFilters)&&(u=a.attr("filters")),n=!!d.nonInteractive);d=f===m?u:f?f(b.filter):null;e!==j&&l.updateMatrix(e,a,b);h!==k&&(d=l.updateColorTransform(h,k,d,a,b));K(d,u)||a.attr("filters",d);i!==n&&a.attr("interactive",!i);(a=a._animation)&&a.step(c.ratio/65535||0)}},updateMatrix:function(a,b,c){a?b.attr("matrix",new c.Matrix(a.sx,a.rotateSkew0,
a.rotateSkew1,a.sy,a.tx,a.ty)):b.attr("matrix",new c.Matrix)},updateColorTransform:function(a,b,c,d,e){b&&(b.isAlphaOnly?d.attr("opacity",b.previousOpacity):c&&(b=c.indexOf(b.filter),-1!==b&&c.splice(b,1)));if(a){var h,f,i,j,k,m,l;(i=a.add)?(b=i.r,h=i.g,f=i.b,i=i.a):b=h=f=i=0;(l=a.mul)?(j=l.r/256,k=l.g/256,m=l.b/256,l=l.a/256):j=k=m=l=1;var n=d.attr("opacity");0===b+h+f&&1===j*k*m?(a.isAlphaOnly=!0,a.previousOpacity=n,d.attr("opacity",R(1,Q(0,n*l+i/255)))):(a=a.filter=new e.filter.ColorMatrix([j,
0,0,0,b/255,0,k,0,0,h/255,0,0,m,0,f/255,0,0,0,l,i/255]),c?c.push(a):c=[a])}return c},updateDisplayList:function(a,b,c,d){if(a===b)return null;for(var e=[],h=Math.max(a.length,b.length),f=0;f<h;f+=1)l.updateDisplayListElement(a[f],b[f],f,c,d,e);return e},updateDisplayListElement:function(a,b,c,d,e,h){a!==b&&this.executeUpdateAction(l.getUpdateAction(a,b),a,b,c,d,e,h)},getUpdateAction:function(a,b){return b?a?a.placementId!==b.placementId?2:3:2:1},executeUpdateAction:function(a,b,c,d,e,h,f){e=e.displayList.getSwfObject(d);
3===a?(d=c.clipDepth?e.attr("clip"):e,l.styleCharacter(d,h.bonsai,c,b)):(l.removeCharacter(e,b&&b.objectName),2===a&&(b=E.getInstance(c.characterId,h,l.initSprite),l.styleCharacter(b,h.bonsai,c),f.push({bonsaiObject:b,clipDepth:c.clipDepth,depth:d,objectName:c.objectName})))},initSprite:function(a,b,c){var d=a.frames;b.swf={frameLabels:a.frameLabels||{},frames:d};if(b.length){b.length(d.length);for(var d=(a=a.stopCalls)?a.length:0,e=0;e<d;e+=1)b.on(a[e],J)}l.gotoFrame(b,0,c)},removeCharacter:function(a,
b){if(a){var c=a.__flash__,d=c.parent;d?(d.removeChild(c),b&&(d[b]=null)):a.remove()}},_dictionary:E};p.module$exports=l;p.module$exports&&(p=p.module$exports);var q={},S=p,F={constructChildren:function(a,b){var c,d=a.swf;if(d&&d.newChildren){for(var e=d.newChildren,h=0,f;f=e[h];h+=1){var i=f.clipDepth,j=f.bonsaiObject,k=j.__flash__,l=f.objectName;i?(c=new bonsai.Group,c.attr("data","clip"),a.displayList.placeSwfClip(j,c,f.depth,i,b,k)):a.displayList.placeSwfObject(j,f.depth,b,k);k&&(l&&(k[tools.expando].name=
l),k.constructor());l&&(b[l]=k)}d.newChildren=null}},"goto":function(a,b,c,d){S.gotoFrame(a,b,d)&&F.constructChildren(a,c)}};q.module$exports=F;q.module$exports&&(q=q.module$exports);var s={},T=p,U=q.constructChildren;s.module$exports={playFirstFrame:function(a,b){var c=a.__flash__;b.vmToplevel.global.stage.addChildAt(c,0);c.constructor()},playFrame:function(a,b){for(var c=T.playSwfFrame(a,b),d=0,e;e=c[d];d+=1)U(e,e.__flash__)}};s.module$exports&&(s=s.module$exports);var m={},z=n,O=o,B=q,C=s,A=p,
n={playSwf:function(a,b,c,d){var e=a.bonsai.stage;e.setBackgroundColor(c);L(a);e.toplevel=a.vmToplevel;c=z.getInstance(0,a,A.initSprite);M(a);N(d,e,c,a,b);return c},preprocessDictionary:r.preprocessDictionary,_registerSymbolClass:y},o=Function("return this")();o.exports=o.exports||{};o.exports.transwf=n;m.module$exports=n;m.module$exports&&(m=m.module$exports)})();
