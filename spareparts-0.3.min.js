/**
 * spareparts is (C) 2012 uxebu Inc.
 * 
 * No permission or right to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software is granted.
 * All rights reserved to the copyright holders.
 */
(function(){var Group=bonsai.Group,tools=bonsai.tools,Button=function(){Group.call(this);this.childrenWrapper=(new Group).addTo(this);this.eventArea=(new Group).attr({opacity:0,cursor:"pointer"}).addTo(this);this.stateChildren={normal:new Group,hover:new Group,active:new Group};this.setupConnections();this.childrenWrapper.addChild(this.stateChildren.normal)};
Button.prototype=tools.mixin(Object.create(Group.prototype),{childrenWrapper:null,eventArea:null,stateChildren:null,isMouseDown:!1,isMouseOver:!1,type:"Group",addActiveStateChild:function(d,e){this.addStateChild(d,"active",e)},addEventAreaChild:function(d,e){this.eventArea.addChild(d,e)},addHoverStateChild:function(d,e){this.addStateChild(d,"hover",e)},addNormalStateChild:function(d,e){this.addStateChild(d,"normal",e)},addStateChild:function(d,e,j){this.stateChildren[e].addChild(d,j)},displayState:function(d){this.stateChildren[d].children().length&&
this.childrenWrapper.clear().addChild(this.stateChildren[d])},onMouseDown:function(){this.isMouseDown=!0;this.displayState("active")},onMouseUp:function(){this.isMouseDown=!1;this.displayState(this.isMouseOver?"hover":"normal")},onMouseOver:function(){this.isMouseOver=!0;this.displayState(this.isMouseDown?"active":"hover")},onMouseOut:function(){this.isMouseOver=!1;this.displayState(this.isMouseDown?"hover":"normal")},setupConnections:function(){this.eventArea.on("mouseover",tools.hitch(this,"onMouseOver"));
this.eventArea.on("mouseout",tools.hitch(this,"onMouseOut"));this.eventArea.on("pointerdown",tools.hitch(this,"onMouseDown"));this.eventArea.on("pointerup",tools.hitch(this,"onMouseUp"))}});exports.Button=Button;(function(){function d(){for(var d in e)this[d]=e[d]}var e={align:"left",blockIndent:0,bold:!1,bullet:!1,color:0,font:"Times New Roman",indent:0,italic:!1,kerning:!1,leading:0,leftMargin:0,letterSpacing:0,rightMargin:0,size:12,tabStops:[],target:"",underline:!1,url:""};d.defaults=JSON.parse(JSON.stringify(e));exports.TextFormat=d})();
(function(){function d(a,b){var c=[],d="__string__"+ +new Date,a=a.replace(/(['"])(?:\\\1|[^\1])*?\1/g,function(a){c.push(a);return d}),a=a.replace(/[^}]+\{/g,function(a){a=a.replace(/^\s+|\s+$/,"");return a.replace(/^|(,)/g,"$1 "+b+" ").replace(/^\s|(\s)\s+/g,"$1")});return a=a.replace(RegExp(d,"g"),function(){return c.shift()})}function e(){return this._owner.raw.styleSheet}function j(a){var b=this._owner,c=b._cssSelectorPrefix;a?(a=d(a,c),b.raw.styleSheet=a,b._style||(b._style=new g("style"),b.addChild(b._style)),
this._defaultStyleSheet||(this._defaultStyleSheet=d(o,c)),b._style.setAttribute("innerHTML",this._defaultStyleSheet+a)):b.raw.styleSheet=""}function p(){return this._owner.raw.autoSize}function q(a){var b=this._owner;b.raw.autoSize=a=a||"none";switch(a){case "none":b.innerBox.setStyles({"float":"",width:"100px",height:"100px"});break;case "left":b.innerBox.setStyles({"float":"left",width:"auto",height:"auto"});break;case "right":b.innerBox.setStyles({"float":"right",width:"auto",height:"auto"});b.text.setStyle("float",
"right");b.text.setStyle("textAlign","right");break;case "center":b.innerBox.setStyles({display:"inline-block",width:"auto",height:"auto"}),b.setStyle("textAlign","center")}}function r(){return!!this._owner.raw.editable}function s(a){var a=!!a,b=this._owner;b.raw.editable=a;!0===a?(b.text.setAttribute("contenteditable","true"),b.text.setStyles({webkitUserModify:"read-write",webkitNbspMode:"space",webkitLineBreak:"after-white-space"}),b.addCSSRule(":focus","outline: none")):(b.text.setAttribute("contenteditable",
"false"),b.text.setStyles({webkitNbspMode:"",webkitLineBreak:""}))}function t(){return!!this._owner.raw.html}function u(a){this._owner.raw.html=!!a}function v(){return this._owner.raw.htmlText||""}function w(a){var b=this._owner;!1!==b.attr("html")&&b.innerHTML(a)}function x(){return this._owner.raw.maxChars}function y(a){this._owner.raw.maxChars=a}function z(){return!!this._owner.raw.password}function A(a){var a=!!a,b=this._owner;b.raw.password=a;!0===a&&b.attr("text",Array(b.text.getAttribute("innerHTML").length+
1).join("*"))}function B(){var a;a=this._owner.attr("htmlText");var b=a.match(RegExp("<TEXTFORMAT.*"+m+">(.*)"));b&&b[1]&&(a=b[1].split(/<\/TEXTFORMAT>(.+)?/),a=k+a[0]+k+(a[1]||""));return f.unescapeHtml(a)}function C(a){for(var b=this._owner,c=b.attr("maxChars"),a=a||"",a=null===c?a:a.slice(0,c),c="",a=a.split(k),d=0,e=a.length;d<e;d++)0!==a[d].length&&(c+=b.htmlFromText(a[d],d%2));b.innerHTML(c);b.emit("change")}function D(){return!!this._owner.raw.selectable}function E(a){this._owner.raw.selectable=
!!a}function F(){return!!this._owner.raw.background}function G(a){var b=this._owner;b.raw.background=!!a;b.attr("backgroundColor",b.attr("backgroundColor"))}function H(){var a=this._owner;return!0===a.attr("background")?a.raw.backgroundColor:h.backgroundColor}function I(a){var b=this._owner;(b.raw.backgroundColor=a)&&b.attr("background")?b.innerBox.setStyle("backgroundColor",bonsai.color(256*a+255).rgba()):b.innerBox.setStyle("backgroundColor","rgba(0, 0, 0, 0)")}function J(){return!!this._owner.raw.border}
function K(a){var b=this._owner;b.raw.border=!!a;b.attr("borderColor",b.attr("borderColor"))}function L(){var a=this._owner;return!0===a.attr("border")?a.raw.borderColor:h.borderColor}function M(a){var b=this._owner;(b.raw.borderColor=a)&&b.attr("border")?b.innerBox.setStyles({borderWidth:"1px",borderColor:bonsai.color(256*a+255).rgba(),borderStyle:"solid"}):b.innerBox.setStyles({borderColor:"",borderWidth:"0px"})}function N(){return!!this._owner.raw.wordWrap}function O(a){var a=!!a,b=this._owner;
b.raw.wordWrap=a;!0===a&&b.attr("multiline")?b.text.setStyles({whiteSpace:"normal",display:""}):b.text.setStyles({whiteSpace:"nowrap",display:"inline-block"})}function P(){return!!this._owner.raw.multiline}function Q(a){var b=this._owner;b.raw.multiline=!!a;b.attr("wordWrap",b.attr("wordWrap"))}function R(){return this._owner.raw.width}function S(a){var b=this._owner;b.raw.width=a;"none"===b.attr("autoSize")&&b.innerBox.setStyle("width",a+"px")}function T(){return this._owner.raw.height}function U(a){var b=
this._owner;b.raw.height=a;"none"===b.attr("autoSize")&&b.innerBox.setStyle("height",a+"px")}function V(){return this._owner.raw.align}function W(a){var b=this._owner;b.raw.align=a;b.parent.setStyle("textAlign",a||"")}function X(){return this._owner.raw.bold}function Y(a){var a=!!a,b=this._owner;b.raw.bold=a;b.setStyle("fontWeight",a?"700":"normal")}function Z(){return this._owner.raw.color}function $(a){var b=this._owner;b.raw.color=a;0<=a?b.setStyle("color",bonsai.color(256*a+255).rgba()):b.setStyle("color",
"")}function aa(){return this._owner.raw.font}function ba(a,b){var c=this._owner;l.isArray(a)?(b=a[1]+", "+a[0],c.raw.font=a[0]):(b=a,c.raw.font=a);c.setStyle("fontFamily",b)}function ca(){return this._owner.raw.indent}function da(a){var b=this._owner;b.raw.indent=a;b.setStyle("textIndent",a||"")}function ea(){return this._owner.raw.italic}function fa(a){var a=!!a,b=this._owner;b.raw.italic=a;b.setStyle("fontStyle",a?"italic":"")}function ga(){return this._owner.raw.leftMargin}function ha(a){var b=
this._owner;b.raw.leftMargin=a;b.setStyle("paddingLeft",a+"px")}function ia(){return this._owner.raw.rightMargin}function ja(a){var b=this._owner;b.raw.rightMargin=a;b.setStyle("paddingRight",a+"px")}function ka(){return this._owner.raw.letterSpacing}function la(a){var b=this._owner;b.raw.letterSpacing=a;b.setStyle("letterSpacing",a+"px")}function ma(){return this._owner.raw.size}function na(a){var a=+a,b=this._owner;b.raw.size=a;b.setStyle("fontSize",a+"px")}function oa(){return this._owner.raw.underline}
function pa(a){var a=!!a,b=this._owner;b.raw.underline=a;b.setStyle("textDecoration",a?"underline":"")}function qa(){return this._owner.raw.leading}function ra(){}function f(){g.call(this,"div");this._domID="bs-textfield-"+this.id;this._domInnerClass=this._domID+"-innerText";this._cssSelectorPrefix="#"+this._domID+" ."+this._domInnerClass;this.setAttribute("id",this._domID);this.innerBox=(new g("div",{"class":this._domID+"-innerBox"},{overflow:"hidden",width:"100%",height:"100%",display:"inline-block",
boxSizing:"border-box",MozBoxSizing:"border-box"})).addTo(this);this.raw={};Object.defineProperties(this._attributes,{wordWrap:c(N,O,!0),multiline:c(P,Q,!0),autoSize:c(p,q,!0),background:c(F,G,!0),backgroundColor:c(H,I,!0),border:c(J,K,!0),borderColor:c(L,M,!0),html:c(t,u,!0),htmlText:c(v,w,!0),maxChars:c(x,y,!0),password:c(z,A,!0),text:c(B,C,!0),selectable:c(D,E,!0),editable:c(r,s,!0),width:c(R,S,!0),height:c(T,U,!0),styleSheet:c(e,j,!0)});this.css=(new g("style")).addTo(this.innerBox);this.css.raw=
{};this.addCSSRule("a","color:inherit; text-decoration:none;");this.addCSSRule("p","padding:0; margin:0; word-wrap:normal;");this.text=(new g("span",{"class":this._domInnerClass})).addTo(this.innerBox);this.text.raw={};Object.defineProperties(this.text._attributes,{align:c(V,W,!0),bold:c(X,Y,!0),color:c(Z,$,!0),font:c(aa,ba,!0),indent:c(ca,da,!0),italic:c(ea,fa,!0),leftMargin:c(ga,ha,!0),rightMargin:c(ia,ja,!0),letterSpacing:c(ka,la,!0),size:c(ma,na,!0),underline:c(oa,pa,!0),leading:c(qa,ra,!0)});
for(var a in h)this.attr(a,h[a]);a=new n;for(var b in a)this.text.attr(b,a[b]);this.text.raw.defaults=n.defaults}var g=bonsai.DOMElement,n=exports.TextFormat,l=bonsai.tools,c=l.descriptorAccessor,o="a{color:#000;text-decoration:none;}",h={autoSize:"none",background:!1,backgroundColor:16777215,border:!1,borderColor:0,html:!0,htmlText:"",maxChars:null,text:"",selectable:!1,password:!1,wordWrap:!1,editable:!1,width:100,height:100,styleSheet:""},m='bs-swf="true"',k="\ufeff\ufeff",i=f.prototype=l.beget(g.prototype);
i.addCSSRule=function(a,b){var c="",d=this.css,e=this._cssSelectorPrefix;d.raw[a]=b;var f,g;for(g in d.raw)f=d.raw[g],c+=e+" "+g+" { "+f+" }\n";d.setAttribute("innerHTML",c);return this};i.hasCSSRule=function(a){return a in this.css.raw};i.innerHTML=function(a){this.text.setAttribute("innerHTML",a);this.raw.htmlText=a;this.emit("change");return this};i.htmlFromText=function(a,b){this.addCSSRule("font","font-size:inherit; color:inherit; font-family:inherit;");return f.htmlTextFormatWrapper("<P><FONT>"+
f.escapeHtml(a)+"</FONT></P>",b)};f.escapeHtml=function(a){return a.replace(/&/g,"&amp;").replace(/ /g,"&nbsp; ").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br/>")};f.unescapeHtml=function(a){return a.replace(/&amp;/g,"&").replace(/&nbsp; /g," ").replace(/<br\/>/g,"\n").replace(/<(?:.|\n)*?>/gm,"").replace(/\&lt;/g,"<").replace(/\&gt;/g,">")};f.htmlTextFormatWrapper=function(a,b){return"<TEXTFORMAT"+(b?" "+m:"")+">"+a+"</TEXTFORMAT>"};exports.TextField=f})();}());
