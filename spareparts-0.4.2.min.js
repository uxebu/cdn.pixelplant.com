/**
 * spareparts is (C) 2012 uxebu Inc.
 * 
 * No permission or right to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software is granted.
 * All rights reserved to the copyright holders.
 */
(function(){var Group=bonsai.Group,tools=bonsai.tools,Button=function(){Group.call(this);this.childrenWrapper=(new Group).addTo(this);this.eventArea=(new Group).attr({opacity:0,cursor:"pointer"}).addTo(this);this.stateChildren={normal:new Group,hover:new Group,active:new Group};this.setupConnections();this.childrenWrapper.addChild(this.stateChildren.normal)};
Button.prototype=tools.mixin(Object.create(Group.prototype),{childrenWrapper:null,eventArea:null,stateChildren:null,isMouseDown:!1,isMouseOver:!1,type:"Group",addActiveStateChild:function(d,e){this.addStateChild(d,"active",e)},addEventAreaChild:function(d,e){this.eventArea.addChild(d,e)},addHoverStateChild:function(d,e){this.addStateChild(d,"hover",e)},addNormalStateChild:function(d,e){this.addStateChild(d,"normal",e)},addStateChild:function(d,e,i){this.stateChildren[e].addChild(d,i)},displayState:function(d){this.stateChildren[d].children().length&&
this.childrenWrapper.clear().addChild(this.stateChildren[d])},onMouseDown:function(){this.isMouseDown=!0;this.displayState("active")},onMouseUp:function(){this.isMouseDown=!1;this.displayState(this.isMouseOver?"hover":"normal")},onMouseOver:function(){this.isMouseOver=!0;this.displayState(this.isMouseDown?"active":"hover")},onMouseOut:function(){this.isMouseOver=!1;this.displayState(this.isMouseDown?"hover":"normal")},setupConnections:function(){this.eventArea.on("mouseover",tools.hitch(this,"onMouseOver"));
this.eventArea.on("mouseout",tools.hitch(this,"onMouseOut"));this.eventArea.on("pointerdown",tools.hitch(this,"onMouseDown"));this.eventArea.on("pointerup",tools.hitch(this,"onMouseUp"))}});exports.Button=Button;(function(){function d(){for(var d in e)this[d]=e[d]}var e={align:"left",blockIndent:0,bold:!1,bullet:!1,color:0,font:"Times New Roman",indent:0,italic:!1,kerning:!1,leading:0,leftMargin:0,letterSpacing:0,rightMargin:0,size:12,tabStops:[],target:"",underline:!1,url:""};d.defaults=JSON.parse(JSON.stringify(e));exports.TextFormat=d})();
(function(){function d(a,b){var c=[],d="__string__"+ +new Date,a=a.replace(/(['"])(?:\\\1|[^\1])*?\1/g,function(a){c.push(a);return d}),a=a.replace(/[^}]+\{/g,function(a){a=a.replace(/^\s+|\s+$/,"");return a.replace(/^|(,)/g,"$1 "+b+" ").replace(/^\s|(\s)\s+/g,"$1")});return a=a.replace(RegExp(d,"g"),function(){return c.shift()})}function e(){return this._owner.raw.styleSheet}function i(a){var b=this._owner,c=b._cssSelectorPrefix;a?(a=d(a,c),b.raw.styleSheet=a,b._style||(b._style=new g("style"),b.addChild(b._style)),
this._defaultStyleSheet||(this._defaultStyleSheet=d(p,c)),b._style.setAttribute("innerHTML",this._defaultStyleSheet+a)):b.raw.styleSheet=""}function q(){return this._owner.raw.autoSize}function r(a){var b=this._owner;b.raw.autoSize=a||"none";switch(a){case "none":b.setStyles({"float":"",width:"100px",height:"100px"});break;case "left":b.setStyles({"float":"left",width:"auto",height:"auto"});break;case "right":b.setStyles({"float":"right",width:"auto",height:"auto"});b.text.setStyle("float","right");
b.text.setStyle("textAlign","right");break;case "center":b.setStyles({display:"inline-block",width:"auto",height:"auto"}),b.setStyle("textAlign","center")}}function s(){return!!this._owner.raw.editable}function t(a){var a=!!a,b=this._owner;b.raw.editable=a;!0===a?(b.text.setAttribute("contenteditable","true"),b.text.setStyles({webkitUserModify:"read-write",webkitNbspMode:"space",webkitLineBreak:"after-white-space"}),b.addCSSRule(":focus",{outline:"none"})):(b.text.setAttribute("contenteditable","false"),
b.text.setStyles({webkitNbspMode:"",webkitLineBreak:""}))}function u(){return!!this._owner.raw.html}function v(a){this._owner.raw.html=!!a}function w(){return this._owner.raw.htmlText||""}function x(a){var b=this._owner;!1!==b.attr("html")&&b.innerHTML(a)}function y(){return this._owner.raw.maxChars}function z(a){this._owner.raw.maxChars=a}function A(){return!!this._owner.raw.password}function B(a){var a=!!a,b=this._owner;b.raw.password=a;!0===a&&b.attr("text",Array(b.text.getAttribute("innerHTML").length+
1).join("*"))}function C(){var a;a=this._owner.attr("htmlText");var b=a.match(RegExp("<TEXTFORMAT.*"+n+">(.*)"));b&&b[1]&&(a=b[1].split(/<\/TEXTFORMAT>(.+)?/),a=j+a[0]+j+(a[1]||""));return f.unescapeHtml(a)}function D(a){for(var b=this._owner,c=b.attr("maxChars"),a=(a||"").toString(),a=null===c?a:a.slice(0,c),c="",a=a.split(j),d=0,e=a.length;d<e;d++)0!==a[d].length&&(c+=b.htmlFromText(a[d],d%2));b.innerHTML(c);b.emit("change")}function E(){return!!this._owner.raw.selectable}function F(a){this._owner.raw.selectable=
!!a}function G(){return!!this._owner.raw.background}function H(a){var b=this._owner;b.raw.background=!!a;b.attr("backgroundColor",b.attr("backgroundColor"))}function I(){var a=this._owner;return!0===a.attr("background")?a.raw.backgroundColor:h.backgroundColor}function J(a){var b=this._owner;b.raw.backgroundColor=a;b.attr("background")?b.innerBox.setStyle("backgroundColor",k(a)):b.innerBox.setStyle("backgroundColor","rgba(0,0,0,0)")}function K(){return!!this._owner.raw.border}function L(a){var b=this._owner;
b.raw.border=!!a;b.attr("borderColor",b.attr("borderColor"))}function M(){var a=this._owner;return!0===a.attr("border")?a.raw.borderColor:h.borderColor}function N(a){var b=this._owner;b.raw.borderColor=a;b.attr("border")?b.innerBox.setStyles({borderWidth:"1px",borderColor:k(a),borderStyle:"solid"}):b.innerBox.setStyles({borderColor:"",borderWidth:"0px"})}function O(){return!!this._owner.raw.wordWrap}function P(a){var a=!!a,b=this._owner;b.raw.wordWrap=a;!0===a&&b.attr("multiline")?b.text.setStyles({whiteSpace:"normal",
display:""}):b.text.setStyles({whiteSpace:"nowrap",display:"inline-block"})}function Q(){return!!this._owner.raw.multiline}function R(a){var b=this._owner;b.raw.multiline=!!a;b.attr("wordWrap",b.attr("wordWrap"))}function S(){return this._owner.raw.width}function T(a){var b=this._owner;b.raw.width=a;"none"===b.attr("autoSize")&&b.setStyle("width",a+"px")}function U(){var a=this._owner,b=a.attr("autoSize");if("undefined"===typeof b||"none"===b)return a.raw.height;b=a.attr("text").split(/\n|\r/).length;
return a.text.attr("size")*b}function V(a){var b=this._owner;b.raw.height=a;"none"===b.attr("autoSize")&&b.setStyle("height",a+"px")}function W(){return this._owner.raw.align}function X(a){var b=this._owner;b.raw.align=a;b.parent.setStyle("textAlign",a||"")}function Y(){return this._owner.raw.bold}function Z(a){var a=!!a,b=this._owner;b.raw.bold=a;b.setStyle("fontWeight",a?"700":"normal")}function $(){return this._owner.raw.color}function aa(a){var b=this._owner;b.raw.color=a;b.setStyle("color",k(a))}
function ba(){return this._owner.raw.font}function ca(a,b){var c=this._owner;l.isArray(a)?(b=a[1]+", "+a[0],c.raw.font=a[0]):(b=a,c.raw.font=a);c.setStyle("fontFamily",b)}function da(){return this._owner.raw.indent}function ea(a){var b=this._owner;b.raw.indent=a;b.setStyle("textIndent",a||"")}function fa(){return this._owner.raw.italic}function ga(a){var a=!!a,b=this._owner;b.raw.italic=a;b.setStyle("fontStyle",a?"italic":"")}function ha(){return this._owner.raw.leftMargin}function ia(a){var b=this._owner;
b.raw.leftMargin=a;b.setStyle("paddingLeft",a+"px")}function ja(){return this._owner.raw.rightMargin}function ka(a){var b=this._owner;b.raw.rightMargin=a;b.setStyle("paddingRight",a+"px")}function la(){return this._owner.raw.letterSpacing}function ma(a){var b=this._owner;b.raw.letterSpacing=a;b.setStyle("letterSpacing",a+"px")}function na(){return this._owner.raw.size}function oa(a){var a=+a,b=this._owner;b.raw.size=a;b.setStyle("fontSize",a+"px")}function pa(){return this._owner.raw.underline}function qa(a){var a=
!!a,b=this._owner;b.raw.underline=a;b.setStyle("textDecoration",a?"underline":"")}function ra(){return this._owner.raw.leading}function sa(){}function f(){g.call(this,"div");this._domID="bs-textfield-"+this.id;this._domInnerClass=this._domID+"-innerText";this._cssSelectorPrefix="#"+this._domID+" ."+this._domInnerClass;this.setAttribute("id",this._domID);this.innerBox=(new g("div",{"class":this._domID+"-innerBox"},{overflow:"hidden",width:"100%",height:"100%",display:"inline-block",boxSizing:"border-box",
MozBoxSizing:"border-box"})).addTo(this);this.raw={};Object.defineProperties(this._attributes,{wordWrap:c(O,P,!0),multiline:c(Q,R,!0),autoSize:c(q,r,!0),background:c(G,H,!0),backgroundColor:c(I,J,!0),border:c(K,L,!0),borderColor:c(M,N,!0),html:c(u,v,!0),htmlText:c(w,x,!0),maxChars:c(y,z,!0),password:c(A,B,!0),text:c(C,D,!0),selectable:c(E,F,!0),editable:c(s,t,!0),width:c(S,T,!0),height:c(U,V,!0),styleSheet:c(e,i,!0)});this.css=(new g("style")).addTo(this.innerBox);this.css.raw={};this.addCSSRule("a",
{color:"inherit","text-decoration":"none"});this.addCSSRule("p",{padding:0,margin:0,"word-wrap":"normal"});this.text=(new g("span",{"class":this._domInnerClass})).addTo(this.innerBox);this.text.raw={};Object.defineProperties(this.text._attributes,{align:c(W,X,!0),bold:c(Y,Z,!0),color:c($,aa,!0),font:c(ba,ca,!0),indent:c(da,ea,!0),italic:c(fa,ga,!0),leftMargin:c(ha,ia,!0),rightMargin:c(ja,ka,!0),letterSpacing:c(la,ma,!0),size:c(na,oa,!0),underline:c(pa,qa,!0),leading:c(ra,sa,!0)});for(var a in h)this.attr(a,
h[a]);a=new o;for(var b in a)this.text.attr(b,a[b]);this.text.raw.defaults=o.defaults}var g=bonsai.DOMElement,o=exports.TextFormat,l=bonsai.tools,c=l.descriptorAccessor,p="a{color:#000;text-decoration:none;}",h={autoSize:"none",background:!1,backgroundColor:16777215,border:!1,borderColor:0,html:!0,htmlText:"",maxChars:null,text:"",selectable:!1,password:!1,wordWrap:!1,editable:!1,width:100,height:100,styleSheet:""},n='bs-swf="true"',j="\ufeff\ufeff",k=f.rgba=function(a){if("undefined"===typeof a)return"rgba(0,0,0,0)";
a=/^#/.test(a)?parseInt(a.slice(1),16):a<<8|255;return bonsai.color(a).rgba()},m=f.prototype=l.beget(g.prototype);m.addCSSRule=function(a,b){var c=this.css,d=this._cssSelectorPrefix;a in c.raw||(c.raw[a]={});for(var e in b)c.raw[a][e]=b[e];var f,g,h,i="";for(h in c.raw){e=c.raw[h];g="";for(f in e)g+=f+": "+e[f]+"; ";i+=d+" "+h+" { "+g+" }\n"}c.setAttribute("innerHTML",i);return this};m.innerHTML=function(a){this.text.setAttribute("innerHTML",a);this.raw.htmlText=a;this.emit("change");return this};
m.htmlFromText=function(a,b){this.addCSSRule("font",{"font-size":"inherit",color:"inherit","font-family":"inherit"});return f.htmlTextFormatWrapper("<P><FONT>"+f.escapeHtml(a)+"</FONT></P>",b)};f.escapeHtml=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n|\r/g,"<br/>")};f.unescapeHtml=function(a){return a.replace(/&amp;/g,"&").replace(/&nbsp; /g," ").replace(/<br\/>/g,"\n").replace(/<(?:.|\n)*?>/gm,"").replace(/\&lt;/g,"<").replace(/\&gt;/g,">")};
f.htmlTextFormatWrapper=function(a,b){return"<TEXTFORMAT"+(b?" "+n:"")+">"+a+"</TEXTFORMAT>"};exports.TextField=f})();}());
